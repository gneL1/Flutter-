# AnimationController
&emsp;&emsp;动画的控制器，控制动画播放状态。
属性|描述
:-|:-|
double value|初始化该动画的值，默认是下边界lowerBound
Duration duration|动画的持续时间
Duration reverseDuration|动画的反转时间
double lowerBound = 0.0|下边界
double upperBound = 1.0|上边界
AnimationBehavior animationBehavior =<br> AnimationBehavior.normal|配置禁用动画时AnimationController的行为
TickerProvider vsycn|当前上下文的TickrProvider

常用控制动画的方法|描述
:-|:-|
forward()|动画开始播放
reverse()|动画反向(往回)播放
stop()|停止动画
reset()|充值动画到起始位置
repeat()|循环播放
animateTo()|将动画当前值改为目标值

&emsp;&emsp;下边界会在动画持续时间内从0.0到达上边界1.0。  
&emsp;&emsp;Ticker这个类会在常规的时间区间内(约每秒60次)发送一个信号，当Ticker启动之后，自从第一个tick到来开始，
每个到的tick都会回调Ticker的callback方法。  
&emsp;&emsp;为了让动画正常工作，必须将AnimationController绑定到Ticker上。

***

# 创建一个动画
1. 让State类withSingleTickerProviderStateMixin

```dart
class AnimationWidgetTestState extends State<AnimationWidgetTest> with SingleTickerProviderStateMixin{
  ......
}
```

2. 创建一个AnimationController对象

```dart
AnimationController _controller;

@override
void initState() {
  // TODO: implement initState
  super.initState();
  //初始化动画控制器，设置动画时间
  _controller = AnimationController(
    vsync: this,
    duration: Duration(milliseconds: 500),
  );
}
```

3. 复写SingleTickerProviderStateMixin的dispose方法释放AnimationController对象

```dart
@override
void dispose() {
  // TODO: implement dispose
  _controller.dispose();
  super.dispose();
}
```

4. 创建Tween对象并调用animate方法，生成新的Animation对象

```dart
Animation<Offset> _animation;

@override
void initState() {
  // TODO: implement initState
  super.initState();
  _animation =Tween<Offset>(
    begin: Offset(ScreenUtil().setWidth(80), ScreenUtil().setHeight(80)),
    end: Offset(ScreenUtil().setWidth(200), ScreenUtil().setHeight(200)),
  ).animate(
    CurvedAnimation(parent: _controller, curve: Curves.ease)
  );
}
```

5. 获取每次刷新时的值。

```dart
child: AnimatedBuilder(
  animation: _animation,
  builder: (BuildContext context, Widget child){
    return Container(
      width: _animation.value.dx,
      height: _animation.value.dy,
      color: Colors.lightBlue,
    );
  },
),
```

&emsp;&emsp;说一下上边界和下边界，这是用来控制动画的比例。上边界为2就是2倍，0.5就是0.5倍，```animationController.value```能获取下边界向上边界逐渐变化过程中的当前值。  
&emsp;&emsp;如果上边界和下边的范围超过0~1,则应该使用```animation.animate(controller)```。  
&emsp;&emsp;否则如果用```animation.CurvedAnimation(parent: _controller, curve: Curves.ease)```,会报错  
```'package:flutter/src/animation/curves.dart': Failed assertion: line 43 pos 12: 't >= 0.0 && t <= 1.0': is not true.```  
&emsp;&emsp;跟随错误点进curves文件夹，可以看到Curve这个抽象类限定了值在t >= 0.0 && t <= 1.0这个范围里。

**完整代码**
```dart 
class AnimationWidgetTest extends StatefulWidget {
  AnimationWidgetTest({ Key key }) : super(key: key);

  @override
  AnimationWidgetTestState createState() => new AnimationWidgetTestState();
}

class AnimationWidgetTestState extends State<AnimationWidgetTest> with SingleTickerProviderStateMixin{

  AnimationController _controller;

  Animation<Offset> _animation;


  @override
  void initState() {
    // TODO: implement initState
    super.initState();
    _controller = AnimationController(
        vsync: this,
        duration: Duration(seconds: 2),
    );

    _animation =Tween<Offset>(
      begin: Offset(ScreenUtil().setWidth(80), ScreenUtil().setHeight(80)),
      end: Offset(ScreenUtil().setWidth(200), ScreenUtil().setHeight(200)),
    ).animate(
      CurvedAnimation(parent: _controller, curve: Curves.ease)
    );
    //      ).animate(_controller);
  }


  @override
  void dispose() {
    _controller.dispose();
    // TODO: implement dispose
    super.dispose();
  }


  void _start(){
    setState(() {
      _controller.forward();

    });
  }

  void _reverse(){
    setState(() {
      _controller.reverse();
    });
  }

  @override
  Widget build(BuildContext context) {
    return UtilAppbar(
      text: '测试动画',
      children: <Widget>[
        Container(
          width: ScreenUtil().setWidth(300),
          height: ScreenUtil().setHeight(300),
          decoration: BoxDecoration(
            border: Border.all(color: Colors.grey)
          ),
          alignment: Alignment.center,
          child: AnimatedBuilder(
            animation: _animation,
            builder: (BuildContext context, Widget child){
              return Container(
                width: _animation.value.dx,
                height: _animation.value.dy,
                color: Colors.lightBlue,
              );
            },
          ),
        ),

        FlatButton(
          onPressed: (){
            _start();
          },
          child: Text('开始'),
        ),

        FlatButton(
          onPressed: (){
            _reverse();
          },
          child: Text('返回'),
        ),
      ],
    );
  }
}
```

![图片示例](https://github.com/gneL1/Flutter-/blob/master/photos/Animations/animation_test_01.gif)

***

# 交织动画
&emsp;&emsp;交织动画即多个动画组成的一个动画，使用```Interval```给每个动画设置一个时间间隔，为每个动画的设置一个取值范围```Tween```，最后使用
```AnimationController```控制总体的动画状态。  
&emsp;&emsp;```Interval```的属性：  
属性|描述
:-|:-|
double begin|动画开始，最大值0.0
double end|动画结束，最大值1.0
Curve curve|动画播放曲线

**完整代码**

```dart
class AnimationWidgetInterval extends StatefulWidget {
  AnimationWidgetInterval({ Key key }) : super(key: key);

  @override
  AnimationWidgetIntervalState createState() => new AnimationWidgetIntervalState();
}

class AnimationWidgetIntervalState extends State<AnimationWidgetInterval> with SingleTickerProviderStateMixin{

  AnimationController _controller;
  Animation<double> _width;
  Animation<double> _height;
  Animation<Color> _color;
  Animation<double> _border;
  Animation<BorderRadius> _borderRadius;

  void _play(){

    if(_controller.isCompleted){
      _controller.reverse();
    }
    else{
      _controller.forward();
    }
  }

  @override
  void initState() {
    // TODO: implement initState
    super.initState();
    _controller = AnimationController(
      vsync: this,
      duration: Duration(seconds: 5),
    );

    _width = Tween<double>(
      begin: 100,
      end: 300
    ).animate(
        CurvedAnimation(
            parent: _controller,
            curve: Interval(0.0, 0.2,curve: Curves.ease)
        )
    );


    _height = Tween<double>(
      begin: 100,
      end: 300
    ).animate(
      CurvedAnimation(
          parent: _controller,
          curve: Interval(0.2, 0.4,curve: Curves.ease))
    );

    _color = ColorTween(
      begin: Colors.blue,
      end: Colors.yellowAccent
    ).animate(
        CurvedAnimation(
          parent: _controller,
          curve: Interval(0.4, 0.6,curve: Curves.ease)
        )
    );

    _borderRadius = Tween<BorderRadius>(
      begin: BorderRadius.circular(0.0),
      end: BorderRadius.circular(150.0)
    ).animate(
      CurvedAnimation(
        parent: _controller,
        curve: Interval(0.6, 0.8,curve: Curves.ease)
      )
    );

    _border = Tween<double>(
      begin: 0,
      end: 25
    ).animate(
      CurvedAnimation(
        parent: _controller,
        curve: Interval(0.8, 1.0,curve: Curves.easeIn)
      )
    );

  }

  @override
  void dispose() {
    // TODO: implement dispose
    _controller.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('交织动画'),
      ),
      body: Padding(
        padding: EdgeInsets.all(ScreenUtil().setWidth(20)),
        child: SingleChildScrollView(
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: <Widget>[
           
              UtilText.title('Interval的使用：'),
              Padding(
                padding: EdgeInsets.only(top: ScreenUtil().setHeight(24),bottom: ScreenUtil().setHeight(24)),
                child: AnimatedBuilder(
                  animation: _controller,
                  builder: (context,child){
                    return Container(
                      width: _width.value,
                      height: _height.value,
                      decoration: BoxDecoration(
                        color: _color.value,
                        borderRadius: _borderRadius.value,
                        border: Border.all(
                          width: _border.value,
                          color: Colors.orange
                        )
                      ),
                    );
                  },
                ),
              ),

              Container(
                alignment: Alignment.center,
                width: ScreenUtil().setWidth(200),
                child: FlatButton(
                  onPressed: (){
                    _play();
                  },
                  color: Colors.lightBlue.withOpacity(0.2),
                  child: Text('toggle'),
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }
}
```

![图片示例](https://github.com/gneL1/Flutter-/blob/master/photos/Animations/animation_interval_01.gif)


